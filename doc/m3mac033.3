.\"*-*- nroff -*-*************************************************************
.\"
.\"			Copyright 1998 Jon Green.
.\"			      All Rights Reserved
.\"
.\"
.\"  System        :
.\"  Module        :
.\"  Object Name   : m3mac033.3
.\"  Created By    : Jon Green
.\"  Created       : Mon Aug 31 21:02:32 1998
.\"  Last Modified : <000719.1013>
.\"
.\"  Description
.\"
.\"  Notes
.\"
.\"  History
.\"
.\"***************************************************************************
.\"
.\"  Copyright (c) 1998 Jon Green.
.\"
.\"  All Rights Reserved.
.\"
.\"  This  document  may not, in  whole  or in part, be  copied,  photocopied,
.\"  reproduced,  translated, or reduced to any  electronic  medium or machine
.\"  readable form without prior written consent from Jon Green.
.\"
.\"***************************************************************************
.\"
.Id $Id: m3mac033.3,v 2.3 2001-12-06 00:04:32 jon Exp $
.Im MicroEmacs shell
.so me.tni
.TH cygnus 3
.XI cygnus - "Open a Cygwin BASH window" shell|command
.XI %cygnus-bin-path 5 "Cygwin BASH directory" shell|variable
.XI %cygnus-hilight  5 "Cygwin shell hilight enable flag" shell|variable
.XI %cygnus-prompt   5 "Cygwin shell prompt" shell|variable
.SH NAME
.Me "|cygnus"
cygnus \- Open a Cygwin BASH window
.br
.Me "|%cygnus-bin-path"
%cygnus-bin-path \- Cygwin BASH directory
.br
.Me "|%cygnus-hilight"
%cygnus-hilight \- Cygwin shell hilight enable flag
.br
.Me "|%cygnus-prompt"
%cygnus-prompt \- Cygwin shell prompt
.Me $a
.SH PLATFORM
Windows '95/'98/NT - win32 ONLY
.SH SYNOPSIS
.na
\fBcygnus\fR
.sp
.B %cygnus-bin-path
"\|\fIpath\fR\|"
.br
.B %cygnus-hilight
[\fC0\fR|\fC1\fR]
.br
.B %cygnus-prompt
"\|\fIhilightString\fR\|"
.ad
.SH DESCRIPTION
\fBcygnus\fR  creates an  interactive  BASH shell  window  within a MicroEmacs
buffer window,  providing a UNIX command line  facility  within the Microsoft
Windows environment. This is a preferable  environment to the MS-DOS shell and
is certainly far more comfortable for those people familiar with UNIX.
.PP
Within the window BASH  commands may be entered and  executed, the results are
shown  in the  window.  Within  the  context  of the BASH  shell  window  then
directory naming conforms to the \fBcygwin\fR standard conventions (as opposed
to the Microsoft directory naming).
.PP
On running  \fBcygnus\fR a new buffer is created called  \fC*cygnus*\fR  which
contains the shell.  Executing  the command  again  creates a new shell window
called  \fC*cygnus1*\fR,  and so on. If a cygwin window is killed off then the
available window is used next time the command is run.
.PP
Additional  controls  are  available  within the shell  window to control  the
editors interaction with the window. The operating mode is shown as a digit on
the buffer mode line, this should  typically  show "3", which  corresponds  to
\fIF3\fR. The operating modes are mapped to keys as follows:-
.IP \fBF2\fR
Locks the  window  and allows  local  editing to be  performed.  All  commands
entered into the window are interpreted by the editors. \fBF2\fR mode is
typically  entered to cut and paste from the window,  search for text  strings
etc. In mode 2, a \fB2\fR is shown on the mode line.
.IP \fBF3\fR
The  normal  operating  mode, text typed into the window is  presented  to the
shell window. Translation of MicroEmacs commands (i.e.  beginning-of-word) are
translated  and passed to the shell. For  interactive  use this is the default
mode. In mode 3, a \fB3\fR is shown on the mode line.
.IP \fBF4\fR
All input is passed to the shell, no MicroEmacs  commands are  interpreted and
keys are passed  straight to the shell window. This mode is used where none of
the keys to be entered are to be interpreted by MicroEmacs. Note that you have
to un-toggle the F4 mode before you can swap buffers as this effectively locks
the editor into the window.
.IP \fBF5\fR
Clears  the  buffer  contents.  This  simply  erases  all  of  the  historical
information in the buffer. The operation of the shell is unaffected.
.LP
To exit the shell then end the shell session using "\fCexit\fR" or "\fCC-d\fR"
as normal and then close the buffer. A short cut "\fCC-c  C-k\fR" is available
to kill off the pipe. However, it is not recommended  that this method is used
as it effectively performs a hard kill of the buffer and attached process
.PP
.B %cygnus-bin-path
is a user  defined  variable  that  defines  the file  system  location of the
\fIcygwin\fR  directory. This variable  \s-1MUST\s0 be defined within the user
start up script in order for the \fBcygnus\fR command to start the shell. With
a default installation of \fIcygwin\fR then the settings are typically defined
as:-
.PP
.B "Release B19"
.Me $emf-scheme
.CS
set-variable %cygnus-bin-path "C:/Cygnus/B19/h-i386~1/bin"
.CE
.Me $ehf-scheme
.B "Release B20"
.Me $emf-scheme
.CS
set-variable %cygnus-bin-path "c:/cygnus/cygwin-b20/H-i586-cygwin32/bin"
.CE
.Me $ehf-scheme
.B %cygnus-hilight
is a boolean  flag  which  controls  how the cygnus  command  shell  window is
hilighted.  This value  \s-1MUST\s0 be defined within the user start up script
prior to executing  \s-1cygnus\s0  if  hilighting is to be enabled; by default
hilighting is disabled. A value of 1 enables shell hilighting i.e.
.Me $emf-scheme
.CS
set-variable %cygnus-hilight 1
.CE
.Me $ehf-scheme
.B %cygnus-prompt
is   an   optional    variable    that   is   used   in    conjunction    with
\fB%cygnus-hilight\fR,  it  defines  the  hilighting  string  identifying  the
prompt.  This  allows the prompt to be  rendered  with a different  color. The
default prompt is \fCbash-2.01$\fR and may be hilighted using a definition:-
.Me $emf-scheme
.CS
set-variable %cygnus-prompt "bash-2.01$"
.CE
.Me $ehf-scheme
The user typically  overrides the prompt  definition  within the \s-1BASH\s0
startup file, a more appropriate definition of the prompt may be:-
.Me $emf-scheme
.CS
set-variable %cygnus-prompt "^[a-z]*@[^>]*>"
.CE 0
.Me $ehf-scheme
.SH NOTES
The \fBcygnus\fR command uses the
.Ht ipipe-shell-command 2
to manage the pipe between the editor and the \fBbash\fR  shell. The window is
controlled by the macro file \fChkcygnus.emf\fR which controls the interaction
with the shell.
.PP
The macro
.B cygnus
in  \fChkcygnus.emf\fR  defines the  parameter  setup to connect to the cygwin
bash shell (Version 19), installed in the default location \fCc:/cygnus\fR. If
your installation of cygnus is in a different  location then correct the macro
to  match  your   install   location,   preferably   correct  by   creating  a
\fImycygnus.emf\fR  file in your user directory simply containing a re-defined
\fBcygnus\fR macro.
.PP
If you have exported some of the cygwin  environment  variables in your
\fCautoexec.bat\fR  then  you  will  have to  figure  out for  yourself  what
variables macro \fIcygnus\fR needs to export - the current configuration is
for a vanilla install.
.PP
The \fBbash\fR shell is executed with options \fIi\fR, for interactive  shell
and \fIm\fR to enable job control.
.SH "TESTED CONFIGURATIONS"
This configuration has only been tested on a Windows '98 installation, whether
this works on NT and  Windows '95 (OEM SR2) is unknown.
.PP
We have only been running  "make"  operations in the shell and do not know how
the likes of "more", "man" or anything other terminal interaction works.
.IP "\fBTested Configurations\fR"
Windows '98 (Pentium 120MHz/Pentium Pro 200MHz/Cyrix 300MHz/Pentium II 450MHz)
.IP
cygwin  version B19.3 - this is the original "cygwin"  distribution + the
latest "coolview.tar.gz" patch.
.br
cygwin version B20 - the latest cygwin distribution.
.SH BUGS
.IP  "\fBBreak Key\fR"
A break in a bash shell is \fCC-c\fR, the macros define the key \fCC-c\ C-c\fR
to perform the break. This  sequence is sent to the process but is not enacted
by the shell. This is a property of the Bash shell rather than MicroEmacs.
.IP "\fBSlow Response\fR"
If you are  getting a very slow  response  from the bash  shell then check the
directory  where  \fIbash\fR was started.  Sometimes there are problems if the
shell is  started  in  "\fCc:/\fR"  (which is  typically  "\fC/\fR")  then the
\fIbash\fR  shell is very  unresponsive  and tends to  '\fIignore  me\fR'  for
periods of time. If it is started in another  location,  i.e.  "\fIc:/temp\fR"
directory, then this problem does not occur.
.IP
You can see the  start-up  location in the top of the buffer when the shell is
started.
.IP "\fBPrompt at top of buffer\fR"
Very, very  occasionally  the ishell sticks at the top of the
buffer with only a couple of lines  showing. A swap of the buffers or
a quick window resize sorts out the problem. A fix for this problem has been
applied but still may occasionally occur.
.IP "\fBWinOldAp\fR"
.B Winoldap
is created by the Microsoft  environment  whenever a BASH shell is created. On
occasions  where  processes have terminated  badly the user may be prompted to
kill these off; this is the normal behaviour of windows. It is strongly advised
that all of the BASH  processes  are killed from within the Bash shell  itself
and the shell is always exited correctly (i.e. \fCexit\fR)  before leaving the
editor. The Windows operating system for '95/'98 is not particularly resilient
to erroneous  processes  (for those of us familiar with UNIX) and can bring the
whole  system  down. I believe  that NT does not  suffer  from these  problems
(much).
.IP "\fBLocked Input\fR"
There are  occasions  after  killing a process the editor  appears to lock up.
This is typically a case that the old application has not shut down correctly.
Kill off the erroneous task  (\fCAlt-Ctrl-Del\fR  - \fIEnd Task\fR) then bring
the editor under control using a few \fCC-g\fR
.Ht abort-command 2
sequences.
.SH "SEE ALSO"
.na
.Ht ipipe-shell-command 2 ,
.Ht ishell 3 .
.br
Cygnus Win32 home sites
.B www.cygnus.com
and
.B www.cygnus.co.uk
.ad
.FH
