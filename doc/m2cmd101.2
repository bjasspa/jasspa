.\" -*- nroff -*-
.\" This is part of the JASSPA MicroEmacs documentation files.
.\" Copyright (c) 1998-2002 JASSPA (www.jasspa.com)
.\" See the file "me.nrs" for copying and conditions.
.\"
.Id $Id: m2cmd101.2,v 2.6 2002-01-11 21:58:42 jon Exp $
.Im MicroEmacs command|print
.so me.tni
.TH print-buffer 2
.XI print-buffer - "Print buffer, with formatting"
.XI print-region - "Print region, with formatting"
.SH NAME
.Me "|print-buffer"
print-buffer \- Print buffer, with formatting
.br
.Me "|print-region"
print-region \- Print region, with formatting
.Me $a
.SH SYNOPSIS
.na
.I n
.B print-buffer
.br
.I n
.B print-region
.ad
.SH DESCRIPTION
.B print-buffer
and
.B print-region
print the current buffer or region,  respectively, using  high-lighting  where
appropriate. The hilighting assigned to a buffer is defined by the variable
.Ht $buffer-hilight 5
the print scheme is defined with
.Ht print-scheme 2 ,
the
.Ht scheme-editor 3
should be used to create printer schemes.
.PP
The printing  is typically configured using
.Ht print-setup 3 ,
which can be found in the main menu under \fBFile->Printer Setup\fR.
.PP
The numerical  argument  \fIn\fR is generally used for macro  development,  it
changes the default behaviour of these commands as follows:
.IP \fB\-2\fR
Configures  the  printer  and, on win32  platforms,  opens a Windows  printing
dialog box enabling the user to configure  the printer,  font and page layout.
The configuration is stored in the "\fC/print\fR" registry.
.IP \fB\-1\fR
Configures  the  printer, the  configuration  is stored in the  "\fC/print\fR"
registry.
.IP \fB\0\fR
Configures  the  printer  and, on win32  platforms,  opens a Windows  printing
dialog box enabling the user to configure  the printer,  font and page layout.
The required printing is then performed.
.IP \fB\0\fR
Configures  the  printer  and performs the required printing.
.SS "Printing Process"
When either of these commands are executed the macro file  \fCprint.emf\fR  is
executed to configure the printer (in a same vain as  \fCme.emf\fR is executed
to configure  \*(mS for general usage). After the macro file has been executed
the  "\fC/print\fR"   registry  must  contain  the  information  required  for
printing. Following is a list of registry entries and their use:
.IP "\fBflags\fR (\fIinteger\fR)"
The setup flags, defined as a bit mask as follows:-
.IP
\fC0x0f\fR \- Destination of the printer output.
.br
.RS
\fC0x00\fR \- Buffer only.
.br
\fC0x01\fR \- Internal queue.
.br
\fC0x02\fR \- To file only.
.br
\fC0x03\fR \- To file and command line.
.br
.RE
\fC0x01\fR \- Bit set, header enabled.
.br
\fC0x20\fR \- Bit set, footer
.br
\fC0x04\fR \- Bit set, enable line numbers.
.br
\fC0x08\fR \- Bit set, Enable truncated line character (typically \\).
.IP "\fBpaper-x\fR (\fIinteger\fR)"
Paper page width in character cells.
.IP "\fBpaper-y\fR (\fIinteger\fR)"
Paper page depth in character cells.
.IP "\fBpage-x\fR (\fIinteger\fR)"
The logical page width in character cells.
.IP "\fBpage-y\fR (\fIinteger\fR)"
The logical paper depth in character cells.
.IP "\fBspecifier-x\fR (\fIinteger\fR)"
Windows only.
.IP "\fBspecifier-y\fR (\fIinteger\fR)"
Windows only.
.IP "\fBfont-face\fR (\fIstring\fR)"
The name of the font face (Windows only).
.IP "\fBrows\fR (\fIinteger\fR)"
Number rows per output page. 
.IP "\fBcols\fR (\fIinteger\fR)"
Number of columns per output page.
.IP "\fBmtop\fR (\fIinteger\fR)"
The  size of the top  margin  in  character  cells  (i.e.  where  printing  may
commence).
.IP "\fBmbottom\fR (\fIinteger\fR)"
The size of the bottom margin in character cells (i.e. where printing stops).
.IP "\fBmleft\fR (\fIinteger\fR)"
The number of characters of space forming the left magin of the physical page.
.IP "\fBmright\fR (\fIinteger\fR)"
The number of characters of space forming the right magin of the physical page.
.IP "\fBheader\fR (\fIstring\fR)"
The ASCII text string for the header line.
.IP "\fBfooter\fR (\fIstring\fR)"
The ASCII text string for the footer line.
.IP "\fBport\fR (\fIstring\fR)"
Printer port identity.
.IP "\fBbuffer\fR (\fIstring\fR)"
The name of the destination buffer.
.IP "\fBfile\fR (\fIstring\fR)"
The name of the destination file.
.IP "\fBstrip\fR (\fIinteger\fR)"
If \fIinteger\fR value strip spaces from eol.
.IP "\fBdevice\fR (\fIstring\fR)"
The ASCII name of the device (i.e. \fC/dev/lp\fR).
.IP "\fBeof\fR (\fIstring\fR)"
The  printer  codes  for the end of the file, may be the  empty  string if not
reqired.
.IP "\fBeol\fR (\fIstring\fR)"
The printer codes for the end of line character.
.IP "\fBeop\fR (\fIstring\fR)"
The printer codes for the end of a page.
.IP "\fBsof\fR (\fIstring\fR)"
The  printer  codes  for the  start of a file, may be the empty  string if not
required.
.IP "\fBsol\fR (\fIstring\fR)"
The printer codes for the start of a line.
.IP "\fBsop\fR (\fIstring\fR)"
The printer codes for the start of a page.
.IP "\fBscont\fR (\fIstring\fR)"
The printer codes for a start of row continuation.
.IP "\fBecont\fR (\fIstring\fR)"
The printer codes for the end of row continuation.
.IP "\fBhsep\fR (\fIstring\fR)"
The horizonal logical page separator character.
.IP "\fBvsep\fR (\fIstring\fR)"
The vertical logical page separator character.
.IP "\fBwsep\fR (\fIstring\fR)"
The depth in character cells of the vertical logical page separator.
.IP "\fBxsep\fR (\fIstring\fR)"
The width in character cells of the logical horizontal separator.
.IP "\fBbg-color\fR (\fIinteger\fR)"
The background colour number.
.IP "\fBcommand-line\fR (\fIstring\fR)"
The command line to perform a print operation.
.SS "Printing Under Microsoft Windows Environments"
Printing under Microsoft Windows Environments  automatically  invokes a dialog
box to assign and configure the printer page  characteristics.  The dialog box
allows  the  printer to be  selected,  enables  line  numbering,  headers  and
footers.
.PP
The dialog  allows the user to select the font size, by defining the number of
characters that appear on a logical page, and the number of logical pages that
appear  on  a  physical   page.   Selecting  the  logical  and  physical  page
characteristics  determine  the size of the font. For dense pages with a small
typeface then a point size of 6 is appropriate. For clarity, a larger typeface
of 10 or 12 points is advised.
.SH NOTES
The last  printer  configuration  selected by the user is held in the registry
file "\fCprint.erf\fR" which is loaded into the \fI/print-history\fR  registry
section. This feature is implemented in the macro file \fCprint.emf\fR.
.SH BUGS
Landscape printing under Microsoft Windows environments is temperamental.
.PP
Font selection under Microsoft Windows  environments does not always determine
the most appropriate font size.
.PP
The printer  interface  does not support  native  postscript  generation.  (In
progress).
.SH "SEE ALSO"
.na
.Ht print-setup 3 ,
.Ht scheme-editor 3 ,
.Ht print-scheme 2 ,
.Ht hilight 2 ,
.Ht printall 3f ,
.Ht $buffer-hilight 5 .
.ad
.FH
