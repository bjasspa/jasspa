.\" -*- nroff -*-
.\" Copyright (C) 1998-2025 JASSPA (www.jasspa.com)
.\"
.\" This is part of JASSPA's MicroEmacs, see the LICENSE file for licensing and
.\" copying information.
.\"
.\"  Created By    : Detlef Groth & Steven Phillips
.\"  Created       : Mon Aug 31 21:02:32 1998
.\"
.Id $Id: m3mac099.3,v 2.10 2025/11/28 22:31:04 dgroth Exp $
.Im MicroEmacs command
.so me.tni
.TH file-exec 3
.XI file-exec - "Executes  the  current  buffer with compiler/interpreter"
.XI file-format - "Format the current buffer using the a formatter"
.XI file-lint - "check the current buffer for problems using a linter"
.XI major-mode-tools-setup - "File major-mode tool setup"
.SH NAME
.Me "|file-exec"
file-exec - Executes the current buffer using a compiler or interpreter
.br
.Me "|file-format"
file-format \- Format the current buffer using a dedicated formatter
.br
.Me "|file-lint"
file-lint \- check the current buffer for problems using a dedicated linter
.br
.Me "|major-mode-tools-setup"
major-mode-tools-setup \- File major-mode tool setup
.Me $a
.SH SYNOPSIS
\fBfile-exec\fR [ "\fIcommand-line-arguments\fR" ]
.br
\fBfile-format\fR
.br
\fBfile-lint\fR
.br
\fBmajor-mode-tools-setup\fR
.SH DESCRIPTION
The \fBfile-exec\fR macro for interpreted languages executes the current buffer using the command line interpreter
defined for this language. In case of programming languages which needs to be compiled, first the code is compiled to
machine code and then executed. Before the program is executed
.Ht save-some-buffers 2
is executed to allow the user to ensure that all relevant buffers are saved. If bit \fC0x01\fR of the numeric argument
\fIn\fR is clear then all modified buffers are automatically saved, when set (the default) the user is prompted for
each buffer. If bit 0x02 of the numeric argument is clear (the default) the user is prompted for any additional
\fIcommand-line-arguments\fR which are passed to application or the script command. The arguments given are stored in
a buffer variable, and used as the default arguments next time the script is executed.
.PP
After executing the program, an \fC*FHOOK-exec*\fR buffer is opened with the output of the script or program. The
script executes the current buffer if required using the current \*(mS character encodings.
.PP
The  \fBfile-format\fR  macro formats the current buffer using a dedicated 
formatting  tool for the  buffer's  programming  language.  For R for example,
the package `formatR` must be pre-installed
by the user, this is typically done by running `install.packages('formatR')` within an R console.
.PP
The \fBfile-lint\fR macro checks the currently edited file using a language specific linter, for example for R, the
package `lintr` must be installed by the user for instance using the usual `install.packages('lintr)` syntax from
within a R console. 
.PP
The command opens an \fC*FHOOK-lint*\fR buffer with the output from the linter, warnings or styling issues raised are 
typically high-lighted. the buffer is configured to for
.Ht get-next-line 2
to make traverse through the issues as easy as possible.
.SH SETUP
The \fBmajor-mode-tools-setup\fR command can be used to configure the three tools for the current file's major mode, 
this dialog can be accessed by clicking on the bottom left \fBTools\fR button in the
.Ht major-mode-setup 3
dialog. Note, however, that as the tool configurations should work with all files of the same major-mode, the
command-lines should use tags (\fC%\fR\fIl\fR...) rather than literal file names. Of particular importance are the
\fB%f\fR, \fB%p\fR and \fB%"\fR tags, for further details see the documentation for the \fBCommand\fR field of
.Ht file-tool-setup 3 ,
which uses the same format.
.PP
For creators of \*(mS file hooks, the file tools can also support the use of multiple interpreters/tools, e.g.
\fCclang\fR and \fCgcc\fR to compile a C file. The configuration of each tool can include tests to verify the
availability of the tool on the current computer as well as the required command-line to run.
.PP
To get the command \fBfile-exec\fR, \fBfile-format\fR and \fBfile-lint\fR properly working a setup for the relevant
tools for the current buffer's programming language is usually required. The setting are stored in variables like for
instance for the C++ programming language:
.Me $emf-scheme
.CS
; regex for highlighting and making it click aware
add-next-line "*cpp-exec*" "^%f:%l:\\\\d+.+"
add-next-line "*cpp-lint*" "^%f:%l:\\\\d+.+"
; the compiler
set-variable .fhook-cpp.coms "\\bg++\\b" 
; try outs for  execution,  formatting  and  linting,  if 1 is fine 2 is not tried
; fields are \\bcompiler/tool\\btest command line\\b
; hilight error\\bhilight warning\\bcommand line\\b
; line breaks with indentation follow ups are just for better display
; we check with %v[com].exe for the Windows platform to call the build 
; with backslash instead of slash from the current directory
set-variable .fhook-cpp.exec1 "\\b%v[com]\\b%v[com].exe -v\\b\\b\\b
    %v[com] -Wall -O3 -std=c++17 \\"%p%f\\" -o %b %& .\\%b
    %v[args|20|Additional command-line arguments|]\\b"
set-variable .fhook-cpp.exec2 "\\b%v[com]\\b%v[com]  -v\\b\\b\\b
    %v[com] -Wall -O3 -std=c++17 \\"%p%f\\" -o ./%b %& ./%b 
    %v[args|20|Additional command-line arguments|]\\b"
set-variable .fhook-cpp.format1 "\\bastyle\\bastyle -h\\b0\\b\\b
    astyle --indent=spaces=4 %\\"%f%\\"\\bAstyle\\b"
set-variable .fhook-cpp.format2 "\\bclang-format\\bclang-format -h\\b0\\b\\b
    clang-format \\"%f\\% -- -std=c++17\\bClang-format\\b"
set-variable .fhook-cpp.lint1 "\\b%v[com]\\b%v[com] --version\\b0\\b\\b
    %v[com] -Wall -x c++ -fsyntax-only \\"%p%f\\"\\bG++\\b"
set-variable .fhook-cpp.lint2 "\\bclang-tidy\\bclang-tidy --version\\b0\\b\\b
    clang-tidy \\"%f\\" -- -std=c++17\\bClang-tidy\\b"
.CE 0
.Me $ehf-scheme
.SH NOTES
\fBfile-exec\fR, \fBfile-format\fR and \fBfile-lint\fR are macros defined in \fChktools.emf\fR. For programming
lanuages like C++, Fortran and R there are already useful variable defaults defined in the hkHOOK.emf files, the user
can overwrite these settings using \fBmajor-mode-tools-setup\fR.
.PP
The executables or the interpreters must be usually installed and in the system path for the command to function
correctly or the full path might be given in the variable settings. 
.SH "SEE ALSO"
.Ht get-next-line 2 ,
.Ht file-tool-setup 3 ,
.Ht major-mode-setup 3
.Ht c 9 ,
.Ht cpp 9 ,
.Ht f90 9 ,
.Ht go 9 ,
.Ht pas 9 ,
.Ht perl 9 ,
.Ht py 9 ,
.Ht r 9 ,
.Ht tcl 9 .
.FH
